entities:
  seaf.ia.logical_attributes:
    menu: >
<<<<<<< HEAD
      (
        {
          "location": "Архитектура/Информационная/Логическая модель/Атрибуты",
          "link": "/entities/seaf.ia.logical_attributes/registry"
        }
=======
      ([
        {
          "location": "Архитектура/Информационная/Логическая модель/Связи",
          "link": "/entities/seaf.ia.logical_attributes/registry_links"
        },
        {
          "location": "Архитектура/Информационная/Логическая модель/Атрибуты",
          "link": "/entities/seaf.ia.logical_attributes/registry"
        }]
>>>>>>> 35cb811ad4f328d61336f5d2c9e95eb6cd7f6735
      )

    presentations:
      registry:
        type: table
        headers:
          - value: code
            text: Код
          - value: title
            text: Наименование
            link: self_link
          - value: description
            text: Описание
          - value: logical_entity
            text: Логическая сущность
            link: le_link
        source: >
          (
            [$."seaf.ia.logical_attributes".$spread().
                {
                    "code": *.code,
                    "title": *.title,
                    "self_link": "/entities/seaf.ia.logical_attributes/card?id=" & $keys(),
<<<<<<< HEAD
                    "description": *.description,
                    "logical_entity": ($id := *.logical_entity; $$."seaf.ia.logical_entities".$spread()[$keys() = $id].*.title),
                    "le_link": "/entities/seaf.ia.logical_entities/card?id=" & *.logical_entity
=======
                    "logical_entity": ($id := *.logical_entity; $$."seaf.ia.logical_entities".$spread()[$keys() = $id].*.title),
                    "le_link": "/entities/seaf.ia.logical_entities/card?id=" & *.logical_entity,
                    "link_attr": ($id := *.link_attr; $$."seaf.ia.logical_entities".$spread()[$keys() = $id].*.title),
                    "entity_link": "/entities/seaf.ia.logical_entities/card?id=" & *.link_attr
>>>>>>> 35cb811ad4f328d61336f5d2c9e95eb6cd7f6735
                }]
          )

      card:
        type: markdown
        template: templates/logical_attribute.md
        source: >
          (
            $."seaf.ia.logical_attributes".$spread()[$keys()=$params.id].{
                  "id": $keys(),
                  "code": *.code,
                  "title": *.title,
                  "status": *.status,
                  "description": *.description,
                  "pdn_flag": *.pdn_flag,
                  "cde_flag": *.cde_flag,
                  "logical_entity": *.logical_entity,
                  "le_link": "/entities/seaf.ia.logical_entities/card?id=" & *.logical_entity,
                  "business_term": *.business_term,
                  "bt_link": "/entities/seaf.ia.logical_entities/card?id=" & *.business_term
                }
          )

      registry_by_LE:
        type: table
        headers:
          - value: code
            text: Код
          - value: title
            text: Наименование
            link: self_link
<<<<<<< HEAD
          - value: description
            text: Описание
=======
          - value: link_attr
            text: Связанная сущность
            link: entity_link
>>>>>>> 35cb811ad4f328d61336f5d2c9e95eb6cd7f6735
        source: >
          (
            $param_id := $params.id;
            [$."seaf.ia.logical_attributes".$spread()[*.logical_entity = $param_id].({
              "code": *.code,
              "title": *.title,
              "self_link": "/entities/seaf.ia.logical_attributes/card?id=" & $keys(),
<<<<<<< HEAD
              "description": *.description
            })]
=======
              "link_attr": [($id := *.link_attr; $$."seaf.ia.logical_entities".$spread()[$keys() = $id].*.title)],
              "entity_link": "/entities/seaf.ia.logical_entities/card?id=" & *.link_attr
            })]
          )

      registry_by_LA:
        type: table
        headers:
          - value: logical_entity
            text: Связанная сущность
            link: entity_link
          - value: code
            text: Код атрибута
          - value: title
            text: Наименование атрибута
        source: >
          (
          [$."seaf.ia.logical_attributes".*[link_attr=$params.id].
              {
                  "logical_entity": ($id := logical_entity; $$."seaf.ia.logical_entities".$spread()[$keys() = $id].*.title),
                  "entity_link": "/entities/seaf.ia.logical_entities/card?id=" & logical_entity,
                  "code": code,
                  "title": title
              }]
          )

      registry_links:
        type: table
        headers:
          - value: logical_entity
            text: Логическая сущность
            link: self_link
          - value: link_type
            text: Тип связи
          - value: linked_entity
            text: Связанная сущность
            link: entity_link
        source: >
          (
          [$."seaf.ia.logical_attributes".*[link_attr != {}].
              {
                  "logical_entity": ($id := logical_entity; $$."seaf.ia.logical_entities".$spread()[$keys() = $id].*.title),
                  "self_link": "/entities/seaf.ia.logical_entities/card?id=" & logical_entity,
                  "link_type": link_type,
                  "linked_entity": ($id := link_attr; $$."seaf.ia.logical_entities".$spread()[$keys() = $id].*.title),
                  "entity_link": "/entities/seaf.ia.logical_entities/card?id=" & link_attr
              }]
>>>>>>> 35cb811ad4f328d61336f5d2c9e95eb6cd7f6735
          )
